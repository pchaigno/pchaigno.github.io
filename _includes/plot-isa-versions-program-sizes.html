<!--
bpf_lxc:	v3	v2	v1	v1 + alu32	v2 + alu32	ignored
2/1		42	42	43	45		43
2/3		225	262	270	271		263
2/5		454	514	527	530		517
2/4		541	635	649	653		637
2/16		3282	3611	3666	3546		3508
2/18		1118	1222	1232	1245		1227
2/24		2548	2854	2872	2756		2734
2/15		3087	3444	3510	3400		3373
2/17		1137	1262	1269	1285		1275
2/19		2457	2807	2825	2669		2651
2/10		2504	2693	2713	2780		2745
2/7		2050	2224	2235	2223		2208
2/6		190	212	215	221		218
from-container	97	99	100	100		99
2/12		1728	1853	1878	1895		1875
2/14		1723	1846	1871	1888		1865
2/11		1684	1830	1842	1874		1864
2/13		1652	1813	1841	1845		1835
1/0xffff	83	86	87	86		85
to-container	119	125	126	123		122

bpf_host:
2/1		42	42	43	45		43		x
2/5		454	514	527	530		517		x
2/4		541	634	648	653		637		x
2/21		485	513	520	533		524
2/16		3282	3611	3666	3546		3508
2/18		2273	2456	2482	2525		2484
2/24		2708	2988	3008	2922		2896
2/20		432	478	486	493		485
2/15		2821	3168	3220	3144		3113
2/17		1807	2033	2014	2045		2014
2/19		2222	2562	2517	2407		2396
2/23		1790	1894	1919	1983		1943
2/10		3308	3549	3606	3716		3627
2/22		1703	1844	1861	1910		1888
2/7		2678	2920	2938	3004		2976
from-netdev	376	385	385	385		385
from-host	361	364	365	372		370
to-netdev	2842	3048	3053	3107		3060
to-host		2621	2824	2826	2861		2870
-->
<div id="plot-isa-versions-program-sizes"></div>
<script>
var lxc_programs = ['2/1', '2/3', '2/5', '2/4', '2/16', '2/18', '2/24', '2/15', '2/17', '2/19', '2/10', '2/7', '2/6', 'from-container', '2/12', '2/14', '2/11', '2/13', '1/0ffff', 'to-container'];
var host_programs = ['2/21', '2/16', '2/18', '2/24', '2/20', '2/15', '2/17', '2/19', '2/23', '2/10', '2/22', '2/7', 'from-netdev', 'from-host', 'to-netdev', 'to-host'];
var programs = lxc_programs.map(p => 'bpf_lxc ' + p).concat(host_programs.map(p => 'bpf_host ' + p));
var v1ProgramSizes = {
    x: programs,
    y: [43, 270, 527, 649, 3666, 1232, 2872, 3510, 1269, 2825, 2713, 2235, 215, 100, 1878, 1871, 1842, 1841, 87, 126].concat([520, 3666, 2482, 3008, 486, 3220, 2014, 2517, 1919, 3606, 1861, 2938, 385, 365, 3053, 2826]),
    type: 'bar',
    mode: 'markers',
    name: 'v1',
    marker: {
        color: 'rgb(248, 197, 23)',
    }
};
var v1ALU32ProgramSizes = {
    x: programs,
    y: [45, 271, 530, 653, 3546, 1245, 2756, 3400, 1285, 2669, 2780, 2223, 221, 100, 1895, 1888, 1874, 1845, 86, 123].concat([533, 3546, 2525, 2922, 493, 3144, 2045, 2407, 1983, 3716, 1910, 3004, 385, 372, 3107, 2861]),
    type: 'bar',
    mode: 'markers',
    name: 'v1 + alu32',
    visible: 'legendonly',
    marker: {
        color: 'rgb(248, 197, 23)',
    }
};
var v2ProgramSizes = {
    x: programs,
    y: [42, 262, 514, 635, 3611, 1222, 2854, 3444, 1262, 2807, 2693, 2224, 212, 99, 1853, 1846, 1830, 1813, 86, 125].concat([513, 3611, 2456, 2988, 478, 3168, 2033, 2562, 1894, 3549, 1844, 2920, 385, 364, 3048, 2824]),
    type: 'bar',
    mode: 'markers',
    name: 'v2',
    marker: {
        color: 'rgb(152, 201, 62)',
    }
};
var v2ALU32ProgramSizes = {
    x: programs,
    y: [43, 263, 517, 637, 3508, 1227, 2734, 3373, 1275, 2651, 2745, 2208, 218, 99, 1875, 1865, 1864, 1835, 85, 122].concat([524, 3508, 2484, 2896, 485, 3113, 2014, 2396, 1943, 3627, 1888, 2976, 385, 370, 3060, 2870]),
    type: 'bar',
    mode: 'markers',
    name: 'v2 + alu32',
    visible: 'legendonly',
    marker: {
        color: 'rgb(152, 201, 62)',
    }
};
var v3ProgramSizes = {
    x: programs,
    y: [42, 255, 454, 541, 3282, 1118, 2548, 3087, 1137, 2457, 2504, 2050, 190, 97, 1728, 1723, 1684, 1652, 83, 119].concat([485, 3282, 2273, 2708, 432, 2821, 1807, 2222, 1790, 3308, 1703, 2678, 376, 361, 2842, 2621]),
    type: 'bar',
    mode: 'markers',
    name: 'v3',
    marker: {
        color: 'rgb(98, 138, 198)',
    }
};

plotlyReady(function() {
    var data = [v1ProgramSizes, v1ALU32ProgramSizes, v2ProgramSizes, v2ALU32ProgramSizes, v3ProgramSizes];
    var layout = {
        title: '<b>Program Sizes for Each Instruction Set Version</b>',
        barmode: 'group',
        legend: {x: 0.02, y: 0.95},
        margin: {t: 80, l: 30, r: 0, b: 80},
        xaxis: {
            title: "Cilium's BPF programs",
            showticklabels: false
        },
        yaxis: {tickformat: 's'},
        height: 450,
    };
    if (jQuery.browser && jQuery.browser.mobile) {
        layout.dragmode = false;
    }
    Plotly.newPlot('plot-isa-versions-program-sizes', data, layout);
});
</script>
